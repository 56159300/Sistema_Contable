"use strict";(self.webpackChunkSistema_Contable=self.webpackChunkSistema_Contable||[]).push([[558],{5558:(Vt,b,i)=>{i.r(b),i.d(b,{PartidasModule:()=>Gt});var h=i(6895),k=i(4185),g=i(9299),c=i(5861),A=i(8739),Z=i(6308),m=i(7155),I=i(7120),t=i(4650),D=i(5938),x=i(2628),u=i(2340),j=i(529);let N=(()=>{class o{constructor(e){this.http=e,this.endpointPartida="partida",this.endpointDetalle="partidaDetalle"}getPartidaAll(){var e=this;return(0,c.Z)(function*(){return e.http.get(u.N.api.url+e.endpointPartida).toPromise()})()}getPartidaByID(e){var a=this;return(0,c.Z)(function*(){return a.http.get(u.N.api.url+a.endpointPartida+"/"+e).toPromise()})()}savePartida(e){var a=this;return(0,c.Z)(function*(){return a.http.post(u.N.api.url+a.endpointPartida,e).toPromise()})()}deletePartida(e){var a=this;return(0,c.Z)(function*(){return a.http.delete(u.N.api.url+a.endpointPartida+"/"+e).toPromise()})()}updatePartida(e,a){var r=this;return(0,c.Z)(function*(){return r.http.put(u.N.api.url+r.endpointPartida+"/"+e,a).toPromise()})()}getDetalleAll(){var e=this;return(0,c.Z)(function*(){return e.http.get(u.N.api.url+e.endpointDetalle).toPromise()})()}getDetalleByID(e){var a=this;return(0,c.Z)(function*(){return a.http.get(u.N.api.url+a.endpointDetalle+"/"+e).toPromise()})()}saveDetalle(e){var a=this;return(0,c.Z)(function*(){return a.http.post(u.N.api.url+a.endpointDetalle,e).toPromise()})()}deleteDetalle(e){var a=this;return(0,c.Z)(function*(){return a.http.delete(u.N.api.url+a.endpointDetalle+"/"+e).toPromise()})()}updateDetalle(e,a){var r=this;return(0,c.Z)(function*(){return r.http.put(u.N.api.url+r.endpointDetalle+"/"+e,a).toPromise()})()}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(j.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var C=i(4859),U=i(7392),_=i(3546),v=i(8255),y=i(7506),R=i(6706),M=i(4095);function E(o,n){1&o&&(t.TgZ(0,"th",30),t._uU(1,"ID"),t.qZA())}function H(o,n){if(1&o&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.hij(" ",e.partidaID," ")}}function B(o,n){1&o&&(t.TgZ(0,"th",30),t._uU(1,"Fecha Documento"),t.qZA())}function O(o,n){if(1&o&&(t.TgZ(0,"td",31),t._uU(1),t.ALo(2,"timestampLocale"),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.fechaDocumento)," ")}}function $(o,n){1&o&&(t.TgZ(0,"th",30),t._uU(1,"Fecha Registro"),t.qZA())}function G(o,n){if(1&o&&(t.TgZ(0,"td",31),t._uU(1),t.ALo(2,"timestampLocale"),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.fechaRegistro)," ")}}function z(o,n){1&o&&(t.TgZ(0,"th",30),t._uU(1,"Moneda"),t.qZA())}function K(o,n){if(1&o&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.hij(" ",e.moneda," ")}}function W(o,n){1&o&&(t.TgZ(0,"th",30),t._uU(1,"Empresa"),t.qZA())}function V(o,n){if(1&o&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.hij(" ",e.empresa.nombre," ")}}function X(o,n){1&o&&(t.TgZ(0,"th",30),t._uU(1,"Total"),t.qZA())}function tt(o,n){if(1&o&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.hij(" ",e.total," ")}}function et(o,n){1&o&&(t.TgZ(0,"th",30),t._uU(1,"Texto"),t.qZA())}function ot(o,n){if(1&o&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.hij(" ",e.texto," ")}}function at(o,n){1&o&&(t.TgZ(0,"th",32),t._uU(1,"Acciones"),t.qZA())}function nt(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"td",33)(1,"div",34)(2,"button",35)(3,"mat-icon"),t._uU(4,"more_vert"),t.qZA()(),t.TgZ(5,"mat-menu",null,36)(7,"button",37),t.NdJ("click",function(){const s=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.delete(s))}),t._uU(8," Eliminar "),t.qZA()()()()}if(2&o){const e=t.MAs(6);t.xp6(2),t.Q6J("matMenuTriggerFor",e)}}function rt(o,n){1&o&&t._UZ(0,"tr",38)}function it(o,n){1&o&&t._UZ(0,"tr",39)}const lt=function(){return[25,50,100]};let mt=(()=>{class o{constructor(e,a,r,s){this.router=e,this.dialog=a,this.notificationsService=r,this.partidaService=s,this.dataSource=new m.by,this.columns=["partidaID","fechaDocumento","fechaRegistro","moneda","empresa","texto","total","actions"]}ngOnInit(){this.getData(),this.notificationsService.errorCatched("error")}getData(){var e=this;return(0,c.Z)(function*(){e.listPartidas=yield e.partidaService.getPartidaAll(),e.dataSource=new m.by(e.listPartidas)})()}new(){this.router.navigate(["/workspace/procesos/partidas/nuevo"])}edit(e){this.router.navigate(["/workspace/procesos/partidas/edit",e.partidaID])}delete(e){var a=this;this.dialog.open(I.$,{width:"95%",maxWidth:"500px",data:{message:"\xbfEsta seguro que desea eliminarlo?",submit:"Aceptar",cancel:"Cancelar"}}).afterClosed().subscribe(function(){var s=(0,c.Z)(function*(d){d&&(yield a.partidaService.deletePartida(e.partidaID).then(()=>{a.notificationsService.success(),a.getData()}).catch(f=>a.notificationsService.errorCatched(f)))});return function(d){return s.apply(this,arguments)}}())}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(g.F0),t.Y36(D.uw),t.Y36(x.T),t.Y36(N))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-list"]],viewQuery:function(e,a){if(1&e&&(t.Gf(A.NW,7),t.Gf(Z.YE,7)),2&e){let r;t.iGM(r=t.CRH())&&(a.paginator=r.first),t.iGM(r=t.CRH())&&(a.sort=r.first)}},decls:47,vars:8,consts:[[1,"container-fluid"],[1,"d-flex","flex-wrap","justify-content-between"],[1,"d-flex","align-items-center","txt-blue2","mb-4"],[1,"title"],[1,"row"],[1,"col-md-10"],[3,"dataSource"],[1,"col-md-2","d-flex","justify-content-end"],["mat-raised-button","",1,"bg-blue3","txt-white","squared-button","w-auto",3,"click"],[3,"loading"],[1,"row",3,"hidden"],[1,"col-sm-12"],[1,"table-container"],["mat-table","","matSort","","matSortActive","key","matSortDirection","asc","appTableQuery","",1,"table-responsive-sm","table-hover",3,"dataSource"],["matColumnDef","partidaID"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","fechaDocumento"],["matColumnDef","fechaRegistro"],["matColumnDef","moneda"],["matColumnDef","empresa"],["matColumnDef","total"],["matColumnDef","texto"],["matColumnDef","actions"],["mat-header-cell","","class","text-center",4,"matHeaderCellDef"],["mat-cell","","class","text-center",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"d-flex","flex-column-reverse","flex-md-row","align-items-center","justify-content-between"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","",1,"text-center"],["mat-cell","",1,"text-center"],[1,"d-flex","justify-content-center"],["mat-icon-button","",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",1,"txt-red3",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,a){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),t._uU(4," Partidas Contables "),t.qZA()()(),t.TgZ(5,"div",4)(6,"div",5),t._UZ(7,"app-search-bar",6),t.qZA(),t.TgZ(8,"div",7)(9,"button",8),t.NdJ("click",function(){return a.new()}),t._uU(10," Crear nuevo "),t.qZA()()(),t._UZ(11,"app-circular-loading",9),t.TgZ(12,"div",10)(13,"div",11)(14,"mat-card")(15,"mat-card-content")(16,"div")(17,"div",12)(18,"table",13),t.ynx(19,14),t.YNc(20,E,2,0,"th",15),t.YNc(21,H,2,1,"td",16),t.BQk(),t.ynx(22,17),t.YNc(23,B,2,0,"th",15),t.YNc(24,O,3,3,"td",16),t.BQk(),t.ynx(25,18),t.YNc(26,$,2,0,"th",15),t.YNc(27,G,3,3,"td",16),t.BQk(),t.ynx(28,19),t.YNc(29,z,2,0,"th",15),t.YNc(30,K,2,1,"td",16),t.BQk(),t.ynx(31,20),t.YNc(32,W,2,0,"th",15),t.YNc(33,V,2,1,"td",16),t.BQk(),t.ynx(34,21),t.YNc(35,X,2,0,"th",15),t.YNc(36,tt,2,1,"td",16),t.BQk(),t.ynx(37,22),t.YNc(38,et,2,0,"th",15),t.YNc(39,ot,2,1,"td",16),t.BQk(),t.ynx(40,23),t.YNc(41,at,2,0,"th",24),t.YNc(42,nt,9,1,"td",25),t.BQk(),t.YNc(43,rt,1,0,"tr",26),t.YNc(44,it,1,0,"tr",27),t.qZA()(),t.TgZ(45,"div",28),t._UZ(46,"mat-paginator",29),t.qZA()()()()()()()),2&e&&(t.xp6(7),t.Q6J("dataSource",a.dataSource),t.xp6(4),t.Q6J("loading",a.loading),t.xp6(1),t.Q6J("hidden",a.loading),t.xp6(6),t.Q6J("dataSource",a.dataSource),t.xp6(25),t.Q6J("matHeaderRowDef",a.columns),t.xp6(1),t.Q6J("matRowDefColumns",a.columns),t.xp6(2),t.Q6J("pageSizeOptions",t.DdM(7,lt)))},dependencies:[C.lW,U.Hw,_.a8,_.dn,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.ge,m.ev,m.XQ,m.Gk,Z.YE,Z.nU,A.NW,v.VK,v.OP,v.p6,y.s,R.N,M.v]}),o})();var l=i(4006);class ct{}var Y=i(2391),q=i(2474),p=i(9549),Q=i(4144),S=i(4385),w=i(3238),J=i(9429);function st(o,n){if(1&o&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.Q6J("value",e.cuentaID),t.xp6(1),t.AsE(" ",e.codigo,". ",e.nombre," ")}}function dt(o,n){if(1&o&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"formErrorHandler"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",t.lcZ(2,1,e.cuentaIDField)," ")}}function ut(o,n){if(1&o&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"formErrorHandler"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(t.lcZ(2,1,e.debeField))}}function pt(o,n){if(1&o&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"formErrorHandler"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(t.lcZ(2,1,e.haberField))}}function ft(o,n){if(1&o&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.Q6J("value",e.centroCostoID),t.xp6(1),t.hij(" ",e.nombre," ")}}function ht(o,n){if(1&o&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"formErrorHandler"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",t.lcZ(2,1,e.centroCostoIDField)," ")}}let gt=(()=>{class o{constructor(e,a,r,s,d,f){this.dialogRef=e,this.data=a,this.formBuilder=r,this.notificationsService=s,this.centroCostoService=d,this.cuentasContablesService=f}ngOnInit(){this.getData(),this.buildForm()}getData(){var e=this;return(0,c.Z)(function*(){e.listCentroCosto=yield e.centroCostoService.getAll(),e.listCuentas=yield e.cuentasContablesService.getAll()})()}onNoClick(){this.dialogRef.close(null)}confirmed(){0===this.debeField.value&&0===this.haberField.value?this.notificationsService.errorCatched("El debe o el haber deben ser mayor a 0"):(this.partidaDetalle=new ct,this.partidaDetalle.cuentaID=this.cuentaIDField.value,this.partidaDetalle.centroCostoID=""!==this.centroCostoIDField.value?this.centroCostoIDField.value:null,this.partidaDetalle.debe=this.debeField.value,this.partidaDetalle.haber=this.haberField.value,this.partidaDetalle.monto=this.partidaDetalle.debe+this.partidaDetalle.haber,this.partidaDetalle.cuenta=this.listCuentas.find(e=>e.cuentaID===this.cuentaIDField.value),this.partidaDetalle.centroCosto=this.listCentroCosto.find(e=>e.centroCostoID===this.centroCostoIDField.value)),this.dialogRef.close(this.partidaDetalle)}buildForm(){this.form=this.formBuilder.group({cuentaID:["",[l.kI.required]],centroCostoID:[""],monto:[0,[l.kI.required]],debe:[0,[l.kI.required]],haber:[0,[l.kI.required]]})}patchForm(){var e=this;return(0,c.Z)(function*(){e.form.patchValue({cuentaID:e.partidaDetalle.cuentaID,centroCostoID:e.partidaDetalle.centroCostoID,debe:e.partidaDetalle.debe,haber:e.partidaDetalle.haber,monto:e.partidaDetalle.monto})})()}get cuentaIDField(){return this.form.get("cuentaID")}get centroCostoIDField(){return this.form.get("centroCostoID")}get haberField(){return this.form.get("haber")}get debeField(){return this.form.get("debe")}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(D.so),t.Y36(D.WI),t.Y36(l.QS),t.Y36(x.T),t.Y36(Y.k),t.Y36(q.V))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-detalle-dialog-form"]],decls:39,vars:9,consts:[[1,"row-cols-1","text-center"],["form","form",3,"formGroup"],[1,"row"],[1,"col-sm-12"],[1,"form-group"],["appearance","outline"],["formControlName","cuentaID"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-sm-6"],["appTrim","","matInput","","type","number","formControlName","debe",3,"formControl"],["appTrim","","matInput","","type","number","formControlName","haber",3,"formControl"],["formControlName","centroCostoID"],[1,"d-flex","flex-row","justify-content-end"],["mat-button","",3,"click"],["mat-raised-button","",1,"bg-blue3","txt-white","squared-button","w-auto",3,"click"],[3,"value"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"mat-form-field",5)(6,"mat-label"),t._uU(7," Cuenta "),t.qZA(),t.TgZ(8,"mat-select",6),t.YNc(9,st,2,3,"mat-option",7),t.qZA(),t.YNc(10,dt,3,3,"mat-error",8),t.qZA()()(),t.TgZ(11,"div",9)(12,"div",4)(13,"mat-form-field",5)(14,"mat-label"),t._uU(15," Debe "),t.qZA(),t._UZ(16,"input",10),t.YNc(17,ut,3,3,"mat-error",8),t.qZA()()(),t.TgZ(18,"div",9)(19,"div",4)(20,"mat-form-field",5)(21,"mat-label"),t._uU(22," Haber "),t.qZA(),t._UZ(23,"input",11),t.YNc(24,pt,3,3,"mat-error",8),t.qZA()()(),t.TgZ(25,"div",3)(26,"div",4)(27,"mat-form-field",5)(28,"mat-label"),t._uU(29," Centro de costo "),t.qZA(),t.TgZ(30,"mat-select",12),t.YNc(31,ft,2,2,"mat-option",7),t.qZA(),t.YNc(32,ht,3,3,"mat-error",8),t.qZA()()()()()(),t._UZ(33,"br"),t.TgZ(34,"div",13)(35,"button",14),t.NdJ("click",function(){return a.onNoClick()}),t._uU(36," Cancelar "),t.qZA(),t.TgZ(37,"button",15),t.NdJ("click",function(){return a.confirmed()}),t._uU(38," Guardar "),t.qZA()()),2&e&&(t.xp6(1),t.Q6J("formGroup",a.form),t.xp6(8),t.Q6J("ngForOf",a.listCuentas),t.xp6(1),t.Q6J("ngIf",a.cuentaIDField.errors),t.xp6(6),t.Q6J("formControl",a.debeField),t.xp6(1),t.Q6J("ngIf",a.debeField.errors),t.xp6(6),t.Q6J("formControl",a.haberField),t.xp6(1),t.Q6J("ngIf",a.haberField.errors),t.xp6(7),t.Q6J("ngForOf",a.listCentroCosto),t.xp6(1),t.Q6J("ngIf",a.centroCostoIDField.errors))},dependencies:[h.sg,h.O5,l._Y,l.Fj,l.wV,l.JJ,l.JL,l.oH,l.sg,l.u,C.lW,p.TO,p.KE,p.hX,Q.Nt,S.gD,w.ey,J.P]}),o})();var P=i(1938),_t=i(597),vt=i(4850),T=i(9602);function Zt(o,n){if(1&o&&(t.TgZ(0,"mat-option",51),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.Q6J("value",e.empresaID),t.xp6(1),t.hij(" ",e.nombre," ")}}function Dt(o,n){if(1&o&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"formErrorHandler"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",t.lcZ(2,1,e.empresaIDField)," ")}}function Ct(o,n){if(1&o&&(t.TgZ(0,"mat-option",51),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}function xt(o,n){if(1&o&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"formErrorHandler"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",t.lcZ(2,1,e.empresaIDField)," ")}}function Tt(o,n){if(1&o&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"formErrorHandler"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(t.lcZ(2,1,e.textoField))}}function Ft(o,n){1&o&&(t.TgZ(0,"th",52),t._uU(1,"Cuenta Contable"),t.qZA())}function bt(o,n){if(1&o&&(t.TgZ(0,"td",53),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.AsE(" ",e.cuenta.codigo,". ",e.cuenta.nombre," ")}}function At(o,n){1&o&&(t.TgZ(0,"td",54),t._uU(1,"Total"),t.qZA())}function It(o,n){1&o&&(t.TgZ(0,"th",52),t._uU(1,"Centro de costo"),t.qZA())}function Nt(o,n){if(1&o&&(t.TgZ(0,"td",53),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.hij(" ",null==e.centroCosto?null:e.centroCosto.nombre," ")}}function Ut(o,n){1&o&&t._UZ(0,"td",54)}function yt(o,n){1&o&&(t.TgZ(0,"th",52),t._uU(1,"Monto"),t.qZA())}function Yt(o,n){if(1&o&&(t.TgZ(0,"td",53),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=n.$implicit,a=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,e.monto,a.monedaField.value)," ")}}function qt(o,n){if(1&o&&(t.TgZ(0,"td",54),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,e.getTotalMonto(),e.monedaField.value)," ")}}function Qt(o,n){1&o&&(t.TgZ(0,"th",52),t._uU(1,"Debe"),t.qZA())}function St(o,n){if(1&o&&(t.TgZ(0,"td",53),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=n.$implicit,a=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,e.debe,a.monedaField.value)," ")}}function wt(o,n){if(1&o&&(t.TgZ(0,"td",54),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,e.getTotalDebe(),e.monedaField.value)," ")}}function Jt(o,n){1&o&&(t.TgZ(0,"th",52),t._uU(1,"Haber"),t.qZA())}function Pt(o,n){if(1&o&&(t.TgZ(0,"td",53),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=n.$implicit,a=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,e.haber,a.monedaField.value)," ")}}function Lt(o,n){if(1&o&&(t.TgZ(0,"td",54),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,e.getTotalHaber(),e.monedaField.value)," ")}}function kt(o,n){1&o&&(t.TgZ(0,"th",55),t._uU(1,"Acciones"),t.qZA())}function jt(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"td",56)(1,"div",57)(2,"button",58)(3,"mat-icon"),t._uU(4,"more_vert"),t.qZA()(),t.TgZ(5,"mat-menu",null,59),t._UZ(7,"mat-divider"),t.TgZ(8,"button",60),t.NdJ("click",function(){const s=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.delete(s))}),t._uU(9," Eliminar "),t.qZA()()()()}if(2&o){const e=t.MAs(6);t.xp6(2),t.Q6J("matMenuTriggerFor",e)}}function Rt(o,n){1&o&&t._UZ(0,"td",54)}function Mt(o,n){1&o&&t._UZ(0,"tr",61)}function Et(o,n){1&o&&t._UZ(0,"tr",62)}function Ht(o,n){1&o&&t._UZ(0,"tr",63)}const Bt=function(){return["/workspace/catalogos/proveedores"]};let L=(()=>{class o{constructor(e,a,r,s,d,f,F,zt,Kt){this.notificationsService=e,this.formBuilder=a,this.activeRoute=r,this.dialog=s,this.router=d,this.centroCostoService=f,this.cuentasContablesService=F,this.empresaService=zt,this.partidaService=Kt,this.dataSource=new m.by,this.columns=["cuenta","centroCosto","monto","debe","haber","actions"],this.partidaDetalle=[],this.loading=!0,this.buildForm(),this.router.url.includes("/nuevo")?(this.canEdit=!1,this.baseKey="nuevo"):(this.activeRoute.params.subscribe(Wt=>{this.partidaID=Number(Wt.ID)}),this.canEdit=!0,this.baseKey="edit",this.patchForm()),this.listMonedas=P.YP.Monedas}ngOnInit(){var e=this;return(0,c.Z)(function*(){e.loading=!1,e.listCentroCosto=yield e.centroCostoService.getAll(),e.listCuentas=yield e.cuentasContablesService.getAll(),e.listEmpresas=yield e.empresaService.getAll()})()}create(e){e.preventDefault(),this.canEdit?this.update():(console.log("fasdfasdfasdfsd"),this.save()),this.canEdit=!1}save(){var e=this;return(0,c.Z)(function*(){if(!0===e.form.valid)if(e.getTotalDebe()!==e.getTotalHaber())e.notificationsService.errorCatched("El debe y el haber deben ser iguales");else{const a={empresaID:e.empresaIDField.value,fechaDocumento:e.fechaDocumentoField.value,fechaRegistro:new Date,moneda:e.monedaField.value,texto:e.textoField.value,total:e.totalField.value};yield e.partidaService.savePartida(a).then(r=>{console.log(r),Promise.all(e.partidaDetalle.map(function(){var s=(0,c.Z)(function*(d){console.log(d);const f={partidaID:12,cuentaID:d.cuentaID,centroCostoID:d.centroCostoID,monto:d.monto,debe:d.debe,haber:d.haber};yield e.partidaService.saveDetalle(f).then().catch(F=>e.notificationsService.errorCatched(F)).finally(()=>e.loading=!1)});return function(d){return s.apply(this,arguments)}}())).then(()=>{e.notificationsService.success(),e.router.navigate(["/workspace/procesos/partidas"])})}).catch(r=>e.notificationsService.errorCatched(r)).finally(()=>e.loading=!1)}})()}update(){var e=this;return(0,c.Z)(function*(){if(!0===e.form.valid){const a={partidaID:e.partidaID,empresaID:e.empresaIDField.value,fechaDocumento:e.fechaDocumentoField.value,fechaRegistro:new Date,moneda:e.monedaField.value,texto:e.textoField.value,total:e.totalField.value};yield e.partidaService.updatePartida(e.partidaID,a).then(()=>{e.notificationsService.success(),e.router.navigate(["/workspace/catalogos/partidas"])}).catch(r=>e.notificationsService.errorCatched(r)).finally(()=>e.loading=!1)}})()}delete(e){var a=this;return(0,c.Z)(function*(){a.dialog.open(I.$,{width:"95%",maxWidth:"500px",data:{message:"\xbfEsta seguro que desea eliminarlo?",submit:"Aceptar",cancel:"Cancelar"}}).afterClosed().subscribe(function(){var s=(0,c.Z)(function*(d){});return function(d){return s.apply(this,arguments)}}())})()}buildForm(){this.form=this.formBuilder.group({fechaDocumento:["",[l.kI.required]],moneda:[P.YP.Monedas[0],[l.kI.required]],empresaID:["",[l.kI.required]],texto:["",[l.kI.required]],total:[0]})}patchForm(){var e=this;return(0,c.Z)(function*(){e.form.patchValue({fechaDocumento:e.partida.fechaDocumento,moneda:e.partida.moneda,empresaID:e.partida.empresaID,texto:e.partida.texto,total:e.partida.total})})()}agregarDetalle(){var e=this;this.dialog.open(gt,{data:{listCuentas:this.listCuentas,listCentroCosto:this.listCentroCosto}}).afterClosed().subscribe(function(){var r=(0,c.Z)(function*(s){s&&(console.log(s),e.partidaDetalle.push(s),e.dataSource.data=e.partidaDetalle)});return function(s){return r.apply(this,arguments)}}())}getTotalMonto(){return this.partidaDetalle.map(e=>e.monto).reduce((e,a)=>e+a,0)}getTotalDebe(){return this.partidaDetalle.map(e=>e.debe).reduce((e,a)=>e+a,0)}getTotalHaber(){return this.partidaDetalle.map(e=>e.haber).reduce((e,a)=>e+a,0)}get fechaDocumentoField(){return this.form.get("fechaDocumento")}get monedaField(){return this.form.get("moneda")}get empresaIDField(){return this.form.get("empresaID")}get textoField(){return this.form.get("texto")}get totalField(){return this.form.get("total")}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(x.T),t.Y36(l.QS),t.Y36(g.gz),t.Y36(D.uw),t.Y36(g.F0),t.Y36(Y.k),t.Y36(q.V),t.Y36(_t.o),t.Y36(N))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-form"]],decls:102,vars:21,consts:[[1,"container-fluid"],[1,"d-flex","flex-wrap","justify-content-between"],[1,"d-flex","align-items-center","txt-blue2","mb-4"],[1,"title"],[3,"loading"],[1,"row",3,"hidden"],[1,"col-sm-12"],["form","form",3,"formGroup"],[1,"subtitle"],[1,"d-flex","flex-row","align-items-center","mb-4"],[1,"tag"],[1,"ml-auto"],["mat-button","",1,"w-auto",3,"routerLink"],["mat-raised-button","","type","submit",1,"bg-blue3","txt-white","squared-button","w-auto",3,"click"],[1,"row"],[1,"col-sm-5"],[1,"form-group"],["appearance","outline"],["formControlName","empresaID","required",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-sm-4"],["matInput","","formControlName","fechaDocumento","required","",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],[1,"col-sm-3"],["formControlName","moneda","required",""],[1,"col-sm-9"],["appTrim","","matInput","","type","text","formControlName","texto","minlength","1","maxlength","20",3,"formControl"],["align","end"],["appearance","outline",2,"pointer-events","none"],["matInput","","type","text","formControlName","total",3,"formControl","value"],[1,"mb-3"],[1,"tag","mr-2"],["mat-mini-fab","",2,"background-color","mediumseagreen",3,"click"],[1,"table-container"],["mat-table","","matSort","","matSortActive","key","matSortDirection","asc","appTableQuery","",1,"table-responsive-sm","table-hover",3,"dataSource"],["matColumnDef","cuenta"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","","class","font-weight-bolder",4,"matFooterCellDef"],["matColumnDef","centroCosto"],["matColumnDef","monto"],["matColumnDef","debe"],["matColumnDef","haber"],["matColumnDef","actions"],["mat-header-cell","","class","text-center",4,"matHeaderCellDef"],["mat-cell","","class","text-center",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],[3,"value"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-footer-cell","",1,"font-weight-bolder"],["mat-header-cell","",1,"text-center"],["mat-cell","",1,"text-center"],[1,"d-flex","justify-content-center"],["mat-icon-button","",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",1,"txt-red3",3,"click"],["mat-header-row",""],["mat-row",""],["mat-footer-row",""]],template:function(e,a){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),t._uU(4," Partidas Contables "),t.qZA()()(),t._UZ(5,"app-circular-loading",4),t.TgZ(6,"div",5)(7,"div",6)(8,"form",7)(9,"mat-card")(10,"mat-card-header")(11,"mat-card-title")(12,"div",2)(13,"span",8),t._uU(14),t.qZA()()()(),t.TgZ(15,"mat-card-content")(16,"div",9)(17,"span",10),t._uU(18," Datos generales "),t.qZA(),t.TgZ(19,"div",11)(20,"a",12),t._uU(21," Cancelar "),t.qZA(),t.TgZ(22,"button",13),t.NdJ("click",function(s){return a.create(s)}),t._uU(23," Guardar "),t.qZA()()(),t.TgZ(24,"div",14)(25,"div",15)(26,"div",16)(27,"mat-form-field",17)(28,"mat-label"),t._uU(29," Empresa "),t.qZA(),t.TgZ(30,"mat-select",18),t.YNc(31,Zt,2,2,"mat-option",19),t.qZA(),t.YNc(32,Dt,3,3,"mat-error",20),t.qZA()()(),t.TgZ(33,"div",21)(34,"div",16)(35,"mat-form-field",17)(36,"mat-label"),t._uU(37,"Fecha documento"),t.qZA(),t._UZ(38,"input",22)(39,"mat-datepicker-toggle",23)(40,"mat-datepicker",null,24),t.qZA()()(),t.TgZ(42,"div",25)(43,"div",16)(44,"mat-form-field",17)(45,"mat-label"),t._uU(46," Moneda "),t.qZA(),t.TgZ(47,"mat-select",26),t.YNc(48,Ct,2,2,"mat-option",19),t.qZA(),t.YNc(49,xt,3,3,"mat-error",20),t.qZA()()(),t.TgZ(50,"div",27)(51,"div",16)(52,"mat-form-field",17)(53,"mat-label"),t._uU(54," Texto "),t.qZA(),t._UZ(55,"input",28),t.YNc(56,Tt,3,3,"mat-error",20),t.TgZ(57,"mat-hint",29),t._uU(58),t.qZA()()()(),t.TgZ(59,"div",25)(60,"div",16)(61,"mat-form-field",30)(62,"mat-label"),t._uU(63," Total "),t.qZA(),t._UZ(64,"input",31),t.qZA()()()()(),t.TgZ(65,"mat-card-content")(66,"div",32)(67,"span",33),t._uU(68," Detalle partida "),t.qZA(),t.TgZ(69,"button",34),t.NdJ("click",function(){return a.agregarDetalle()}),t.TgZ(70,"mat-icon"),t._uU(71,"add"),t.qZA()()(),t.TgZ(72,"div")(73,"div",35)(74,"table",36),t.ynx(75,37),t.YNc(76,Ft,2,0,"th",38),t.YNc(77,bt,2,2,"td",39),t.YNc(78,At,2,0,"td",40),t.BQk(),t.ynx(79,41),t.YNc(80,It,2,0,"th",38),t.YNc(81,Nt,2,1,"td",39),t.YNc(82,Ut,1,0,"td",40),t.BQk(),t.ynx(83,42),t.YNc(84,yt,2,0,"th",38),t.YNc(85,Yt,3,4,"td",39),t.YNc(86,qt,3,4,"td",40),t.BQk(),t.ynx(87,43),t.YNc(88,Qt,2,0,"th",38),t.YNc(89,St,3,4,"td",39),t.YNc(90,wt,3,4,"td",40),t.BQk(),t.ynx(91,44),t.YNc(92,Jt,2,0,"th",38),t.YNc(93,Pt,3,4,"td",39),t.YNc(94,Lt,3,4,"td",40),t.BQk(),t.ynx(95,45),t.YNc(96,kt,2,0,"th",46),t.YNc(97,jt,10,1,"td",47),t.YNc(98,Rt,1,0,"td",40),t.BQk(),t.YNc(99,Mt,1,0,"tr",48),t.YNc(100,Et,1,0,"tr",49),t.YNc(101,Ht,1,0,"tr",50),t.qZA()()()()()()()()()),2&e){const r=t.MAs(41);t.xp6(5),t.Q6J("loading",a.loading),t.xp6(1),t.Q6J("hidden",a.loading),t.xp6(2),t.Q6J("formGroup",a.form),t.xp6(6),t.hij(" ","nuevo"===a.baseKey?"Nueva Partida":"Editar Partida"," "),t.xp6(6),t.Q6J("routerLink",t.DdM(20,Bt)),t.xp6(11),t.Q6J("ngForOf",a.listEmpresas),t.xp6(1),t.Q6J("ngIf",a.empresaIDField.errors),t.xp6(6),t.Q6J("matDatepicker",r),t.xp6(1),t.Q6J("for",r),t.xp6(9),t.Q6J("ngForOf",a.listMonedas),t.xp6(1),t.Q6J("ngIf",a.empresaIDField.errors),t.xp6(6),t.Q6J("formControl",a.textoField),t.xp6(1),t.Q6J("ngIf",a.textoField.errors),t.xp6(2),t.hij("",null==a.textoField.value?null:a.textoField.value.length," / 20"),t.xp6(6),t.Q6J("formControl",a.totalField)("value",a.getTotalMonto()),t.xp6(10),t.Q6J("dataSource",a.dataSource),t.xp6(25),t.Q6J("matHeaderRowDef",a.columns),t.xp6(1),t.Q6J("matRowDefColumns",a.columns),t.xp6(1),t.Q6J("matFooterRowDef",a.columns)}},dependencies:[h.sg,h.O5,l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.wO,l.nD,l.oH,l.sg,l.u,C.lW,C.zs,U.Hw,vt.d,_.a8,_.dk,_.dn,_.n5,p.TO,p.KE,p.bx,p.hX,p.R9,Q.Nt,S.gD,w.ey,T.Mq,T.hl,T.nW,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.mD,m.Ke,m.ge,m.ev,m.yh,m.XQ,m.Gk,m.Q2,Z.YE,Z.nU,v.VK,v.OP,v.p6,y.s,g.yS,h.H9,J.P]}),o})();const Ot=[{path:"",component:mt},{path:"nuevo",component:L},{path:"edit/:ID",component:L}];let $t=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[g.Bz.forChild(Ot),g.Bz]}),o})(),Gt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[h.ez,k.m,$t]}),o})()}}]);